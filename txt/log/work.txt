工作记录
=======

:Tue 16 Oct 2012 10:00:09 PM CST

* DrMos Buck 闭环调试

昨天的主要问题是闭环出现问题，当xn为负值时，理论上经过环路运算得到的占空比应该
逐渐减小，而实测的效果是yn达到上钳位值。今天检查系数的时候发现是scaler理解有误
，1(2^1)应该是2。这个地方犯过的错误不止一次了。。

* 电压、电流检测

电压检测和反馈信号现在都统一为1：2了，需要注意计算过程。
电流检测是根据实际测试电压，通过检测值与电流值的对应曲线得到的实际k和b

todo: 电流校准与DCR的对应关系

:Wed 17 Oct 2012 09:20:55 PM CST

* 温度检测

温度检测采用的是ntc电阻，通过芯片内部的电流源驱动，得到电压值进行温度换算，这
里的ntc电阻值与温度是对数的关系，转化过程需要进行ln运算，这种方法没有积累，需
要研究一下，暂定先用查找表先实现功能。

看到两篇文章

http://www.convict.lu/Jeunes/ultimate_stuff/exp_ln_2.htm
http://www.ti.com/lit/an/spra619/spra619.pdf

todo ln定点运算

* dcr电流检测在不同输出电压下有不同偏置

需要研究一下为何输出电压会影响到检测精度，用差分探头测试时似乎是把模块的检测
功能弄坏了，尝试分析一下原因。

done 了解一下DCR原理

:Thu 18 Oct 2012 10:58:27 PM CST

* DCR原理

DCR主要是利用L的寄生电阻DCR进行电流检测，如果L/R和RC的时间常数一致，C上面的
电压就是I*DCR，通过电压就可以得到电流值。

* 运放的共模抑制比

DCR检测出来的信号随着输出电压的变化有共模信号输出，导致运放的输入端在不同设置
的输出电压下有不同的共模输入，而差分运放在不同的共模电压下的输出也会有不同，
导致了上面的问题。更换为一个高阻的4端口运放现象一致。

* NTC检测

采用查表加上差值可以实现NTC检测需要的ln函数
